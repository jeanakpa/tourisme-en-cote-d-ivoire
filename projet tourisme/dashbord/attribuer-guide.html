<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="attribuer-guide.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <title>Ivoire Tourisme</title>
</head>
<body>
  <section>
    <div class="header">
      <h1>Dashbord administration</h1>
    </div>

    <div class="navigation">
        <div class="profil">
          <img src="https://img.freepik.com/free-photo/portrait-young-handsome-african-man-blue-wall_176420-2339.jpg?t=st=1710862915~exp=1710866515~hmac=4ddbf805d45fa3f5b8660cabe05e687912d62fa070592d1dc0d4ae9736ddf089&w=740" alt="">
          <h2>Mister John</h2>
        </div>
        <div class="nav">
          <a href="../accueil.html"><i class="fa-solid fa-right-to-bracket"></i>Deconnexion</a>
          <div class="buttons">
            <button onclick="window.location.href='profil.html'"><i class="fa-solid fa-user"></i>Mon profil</button>
            <button onclick="window.location.href='reservation.html'"><i class="fa-solid fa-bookmark"></i>Reservations</button>
            <button onclick="window.location.href='guide.html'"><i class="fa-solid fa-users"></i>Guides</button>
          </div>
        </div>
      </div>

    <div class="main attribution-block">
      <h2>Attribuer un guide</h2>
      <hr>

      <h3>Détails de la réservation</h3>
      <ul>
        <li>N°: <span id="reservationId"></span></li>
        <li>Site touristique: <span id="reservationSite"></span></li>
        <li>Nom visiteur: <span id="reservationVisitor"></span></li>
        <li>Date: <span id="reservationDate"></span></li>
        <li>Ville: <span id="reservationCity"></span></li>
        <li>Heure: <span id="reservationTime"></span></li>
        <li>Prix: <span id="reservationPrice"></span></li>
        <li>Statut: <span id="reservationStatus"></span></li>

      </ul>

      <h3>Choix du guide</h3>
      <form id="assignGuideForm" method="post" action="">
        <select id="guidesList" name="selectedGuideId">
        </select>
        <button type="submit" id="submitButton">Attribuer ce guide</button>
      </form>
      <ul>
      <li>Guide attribué : <span id="assignedGuide"></span></li>
    </ul>
      <script>
        // Access reservation details from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const reservationId = urlParams.get('reservationId');
        const reservationSite = urlParams.get('reservationSite');
        const reservationVisitor = urlParams.get('reservationVisitor');
        const reservationDate = urlParams.get('reservationDate');
        const reservationCity = urlParams.get('reservationCity');
        const reservationTime = urlParams.get('reservationTime');
        const reservationPrice = urlParams.get('reservationPrice');
        const reservationStatus = urlParams.get('reservationStatus');

        // Populate reservation details
        document.getElementById('reservationId').textContent = reservationId;
        document.getElementById('reservationSite').textContent = reservationSite;
        document.getElementById('reservationVisitor').textContent = reservationVisitor;
        document.getElementById('reservationDate').textContent = reservationDate;
        document.getElementById('reservationCity').textContent = reservationCity;
        document.getElementById('reservationTime').textContent = reservationTime;
        document.getElementById('reservationPrice').textContent = reservationPrice;
        document.getElementById('reservationStatus').textContent = reservationStatus;

        // Fetch available guides (replace with your logic to fetch guide data)
        const guides = [
          { id: 1, name: "Pierre Tourguide" },
          { id: 2, name: "Jeanne Guide" },
          { id: 3, name: "Pierre Tourguide" },
          { id: 4, name: "Jeanne Guide" },
          { id: 5, name: "Pierre Tourguide" },
          { id: 6, name: "Jeanne Guide" },
        ];

        // Populate guides list
        const guidesList = document.getElementById('guidesList');
        guides.forEach(guide => {
          const option = document.createElement('option');
          option.value = guide.id;
          option.textContent = guide.name;
          guidesList.appendChild(option);
        });

        
      </script>
      <script>
        document.getElementById('assignGuideForm').addEventListener('submit', function(event) {
          // Empêcher le comportement par défaut du formulaire
          event.preventDefault();
      
          // Récupérer le guide sélectionné
          const selectedGuide = document.getElementById('guidesList').value;
      
          // Demander confirmation à l'utilisateur
          const confirmed = confirm(`Voulez-vous attribuer le guide "${document.getElementById('guidesList').selectedOptions[0].textContent}" à cette réservation ?`);
      
          // Si l'utilisateur confirme, masquer le bouton et afficher le champ du guide
          if (confirmed) {
            document.getElementById('assignGuideForm').style.display = 'none';
            document.getElementById('assignedGuide').textContent = document.getElementById('guidesList').selectedOptions[0].textContent;
          }
        });
      </script>
      
    </div>
  </section>
</body>
</html>
